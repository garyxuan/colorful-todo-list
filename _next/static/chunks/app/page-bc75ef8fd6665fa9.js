(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9831:function(e,t,a){Promise.resolve().then(a.bind(a,7282))},1088:function(e,t,a){"use strict";a.d(t,{C:function(){return i},SyncProvider:function(){return c}});var s=a(7437),o=a(2265),r=a(4963);let l={startColor:"#F0E6FA",endColor:"#E0F2FE"},n=(0,o.createContext)({isLoggedIn:!1,userEmail:null,lastSync:null,isLoading:!1,autoSync:!0,preferences:l,login:async()=>{},logout:()=>{},syncTodos:async()=>[],updatePreferences:async()=>{},setAutoSync:()=>{},handleLoginSuccess:()=>{}});function c(e){let{children:t}=e,a=(0,r.h)(),[c,i]=(0,o.useState)(!1),[d,u]=(0,o.useState)(null),[m,p]=(0,o.useState)(null),[h,f]=(0,o.useState)(!1),[x,g]=(0,o.useState)(null),[y,b]=(0,o.useState)(!0),[j,v]=(0,o.useState)(l);(0,o.useEffect)(()=>{if(!a)return;let e=localStorage.getItem("token"),t=localStorage.getItem("userEmail"),s=localStorage.getItem("lastSync"),o=localStorage.getItem("preferences"),r=localStorage.getItem("autoSync");if(e&&t&&(g(e),u(t),i(!0)),s&&p(new Date(s)),o)try{v(JSON.parse(o))}catch(e){console.error("Error parsing stored preferences:",e),v(l)}null!==r&&b("true"===r)},[a]);let N=(0,o.useCallback)(()=>{g(null),u(null),p(null),i(!1),v(l),localStorage.removeItem("token"),localStorage.removeItem("userEmail"),localStorage.removeItem("lastSync"),localStorage.removeItem("preferences")},[]),w=(0,o.useCallback)(async e=>{try{localStorage.setItem("token",e),g(e);let t=await fetch("".concat(a,"/auth/me"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("获取用户信息失败");let s=await t.json();u(s.email),p(new Date(s.lastSync)),v(s.preferences||l),i(!0),localStorage.setItem("userEmail",s.email),localStorage.setItem("lastSync",s.lastSync),localStorage.setItem("preferences",JSON.stringify(s.preferences||l))}catch(e){throw console.error("Login error:",e),N(),e}},[N,a]),S=(0,o.useCallback)(()=>{N()},[N]),C=(0,o.useCallback)(async e=>{f(!0);try{let t=await fetch("".concat(a,"/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,preferences:j})});if(!t.ok)throw Error("登录失败");let s=await t.json();g(s.token),u(s.user.email),p(new Date(s.user.lastSync));let o=s.user.preferences||j;v(o),i(!0),localStorage.setItem("token",s.token),localStorage.setItem("userEmail",s.user.email),localStorage.setItem("lastSync",s.user.lastSync),localStorage.setItem("preferences",JSON.stringify(o))}catch(e){throw console.error("Login error:",e),e}finally{f(!1)}},[j,a]),k=(0,o.useCallback)(async e=>{if(!x||!c){v(e),localStorage.setItem("preferences",JSON.stringify(e));return}f(!0);try{let t=await fetch("".concat(a,"/preferences"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x)},body:JSON.stringify({preferences:e})});if(!t.ok)throw Error("更新偏好设置失败");let s=(await t.json()).preferences||e;v(s),localStorage.setItem("preferences",JSON.stringify(s))}catch(t){throw console.error("Update preferences error:",t),v(e),localStorage.setItem("preferences",JSON.stringify(e)),t}finally{f(!1)}},[x,c,a]),E=(0,o.useCallback)(async e=>{if(!x||!c)return e;f(!0);try{if(0===e.length){console.log("Fetching todos from server...");let e=await fetch("".concat(a,"/todos"),{headers:{Authorization:"Bearer ".concat(x),"Content-Type":"application/json"}});if(!e.ok)throw Error("获取云端数据失败");let t=await e.json();if(console.log("Received data from server:",t),!t.todos||!Array.isArray(t.todos))throw console.error("Invalid data format from server:",t),Error("服务器返回的数据格式无效");let s=t.todos.map(e=>({id:e.id,text:e.text||"",completed:!!e.completed,color:e.color||"#F0E6FA",order:Number(e.order)||0})).sort((e,t)=>e.order-t.order);return console.log("Processed todos:",s),p(new Date),localStorage.setItem("lastSync",new Date().toISOString()),s}{console.log("Uploading todos to server:",e);let t=await fetch("".concat(a,"/todos"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x)},body:JSON.stringify({todos:e})});if(!t.ok){let e=await t.json().catch(()=>({}));throw console.error("Upload error:",e),Error(e.details||"同步失败")}let s=await t.json();return console.log("Upload response:",s),p(new Date),localStorage.setItem("lastSync",new Date().toISOString()),e}}catch(e){throw console.error("Sync error:",e),e}finally{f(!1)}},[x,c,a]);return(0,s.jsx)(n.Provider,{value:{isLoggedIn:c,userEmail:d,lastSync:m,isLoading:h,preferences:j,login:C,logout:S,syncTodos:E,updatePreferences:k,autoSync:y,setAutoSync:e=>{b(e),localStorage.setItem("autoSync",String(e))},handleLoginSuccess:w},children:t})}let i=()=>(0,o.useContext)(n)},7282:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Q}});var s=a(7437),o=a(2265),r=a(1994),l=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.m6)((0,r.W)(t))}let c=o.forwardRef((e,t)=>{let{className:a,type:o,...r}=e;return(0,s.jsx)("input",{type:o,className:n("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});c.displayName="Input";var i=a(7053),d=a(535);let u=(0,d.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),m=o.forwardRef((e,t)=>{let{className:a,variant:o,size:r,asChild:l=!1,...c}=e,d=l?i.g7:"button";return(0,s.jsx)(d,{className:n(u({variant:o,size:r,className:a})),ref:t,...c})});m.displayName="Button";var p=a(9270),h=a(401);let f=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,s.jsx)(p.fC,{ref:t,className:n("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...o,children:(0,s.jsx)(p.z$,{className:n("flex items-center justify-center text-current"),children:(0,s.jsx)(h.Z,{className:"h-4 w-4"})})})});f.displayName=p.fC.displayName;var x=a(610);let g=o.forwardRef((e,t)=>{let{className:a,value:o,...r}=e;return(0,s.jsx)(x.fC,{ref:t,className:n("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...r,children:(0,s.jsx)(x.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(o||0),"%)")}})})});g.displayName=x.fC.displayName;var y=a(1341),b=a(8728),j=a(8930),v=a(6394);let N=(0,d.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),w=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,s.jsx)(v.f,{ref:t,className:n(N(),a),...o})});w.displayName=v.f.displayName;let S=(0,o.memo)(function(e){let{label:t,color:a,onChange:r}=e,[l,n]=(0,o.useState)(a);(0,o.useEffect)(()=>{n(a)},[a]);let i=(0,o.useCallback)(e=>{let t=e.target.value;n(t),/^#[0-9A-F]{6}$/i.test(t)&&r(t)},[r]),d=(0,o.useCallback)(e=>{r(e.target.value)},[r]);return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(w,{htmlFor:t,className:"text-sm font-medium text-gray-700",children:t}),(0,s.jsx)(c,{id:"".concat(t,"-color"),type:"color",value:a,onChange:d,className:"w-10 h-10 p-0 border-none"}),(0,s.jsx)(c,{id:"".concat(t,"-text"),type:"text",value:l,onChange:i,className:"w-24 text-sm",placeholder:"#RRGGBB"})]})}),C={en:{todoList:"Todo List",addTodo:"Add",progress:"Progress",completed:"completed",customizeColors:"Customize Colors",startColor:"Start Color",endColor:"End Color",addNewTodo:"Add a new todo",cloudSync:"Cloud Sync",enterEmailToLogin:"Enter your email to login or register",email:"Email",enterEmail:"Enter your email",invalidEmail:"Please enter a valid email",loginFailed:"Login failed, please try again",cancel:"Cancel",confirm:"Confirm",accountInfo:"Account Info",lastSync:"Last Sync",autoSync:"Auto Sync",autoSyncDescription:"Sync automatically every 5 seconds",logout:"Logout",syncChoice:"Choose Sync Direction",syncChoiceDescription:"This account already exists. Choose how to sync your data:",uploadLocal:"Upload Local",uploadLocalDescription:"Upload local data to cloud",downloadCloud:"Download Cloud",downloadCloudDescription:"Download cloud data to local"},zh:{todoList:"待办事项",addTodo:"添加",progress:"进度",completed:"已完成",customizeColors:"自定义颜色",startColor:"起始颜色",endColor:"结束颜色",addNewTodo:"添加新的待办事项",cloudSync:"云同步",enterEmailToLogin:"请输入邮箱地址进行登录或注册",email:"邮箱地址",enterEmail:"请输入邮箱地址",invalidEmail:"请输入有效的邮箱地址",loginFailed:"登录失败，请重试",cancel:"取消",confirm:"确定",accountInfo:"账号信息",lastSync:"上次同步时间",autoSync:"自动同步",autoSyncDescription:"每5秒自动同步一次",logout:"退出登录",syncChoice:"选择同步方式",syncChoiceDescription:"该账号已存在，请选择如何同步数据：",uploadLocal:"上传本地",uploadLocalDescription:"将本地数据上传到云端",downloadCloud:"下载云端",downloadCloudDescription:"将云端数据下载到本地"}},k=(0,o.createContext)(void 0),E=e=>{let{children:t}=e,[a,r]=(0,o.useState)("zh");return(0,s.jsx)(k.Provider,{value:{language:a,setLanguage:r,t:e=>C[a][e]||e},children:t})},I=()=>{let e=(0,o.useContext)(k);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e};var z=a(1088),T=a(4613),D=a(2489);let L=T.fC;T.xz;let O=T.h_;T.x8;let F=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,s.jsx)(T.aV,{ref:t,className:n("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...o})});F.displayName=T.aV.displayName;let A=o.forwardRef((e,t)=>{let{className:a,children:o,...r}=e;return(0,s.jsxs)(O,{children:[(0,s.jsx)(F,{}),(0,s.jsxs)(T.VY,{ref:t,className:n("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r,children:[o,(0,s.jsxs)(T.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(D.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});A.displayName=T.VY.displayName;let P=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:n("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};P.displayName="DialogHeader";let R=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,s.jsx)(T.Dx,{ref:t,className:n("text-lg font-semibold leading-none tracking-tight",a),...o})});R.displayName=T.Dx.displayName;let J=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,s.jsx)(T.dk,{ref:t,className:n("text-sm text-muted-foreground",a),...o})});J.displayName=T.dk.displayName;var U=a(4963);function _(e){let{open:t,onOpenChange:a,onLoginSuccess:r}=e,l=(0,U.h)(),[n,i]=(0,o.useState)(""),[d,u]=(0,o.useState)(""),[p,h]=(0,o.useState)(!1),[f,x]=(0,o.useState)(""),[g,y]=(0,o.useState)(!1),[b,j]=(0,o.useState)(0),v=async()=>{if(!n||!n.includes("@")){x("请输入有效的邮箱地址");return}h(!0),x("");try{console.log("Sending code to:",n),console.log("API URL:","".concat(l,"/auth/send-code"));let e=await fetch("".concat(l,"/auth/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})});console.log("Response status:",e.status);let t=await e.json();if(console.log("Response data:",t),!e.ok)throw Error(t.error||"发送验证码失败");y(!0),j(60);let a=setInterval(()=>{j(e=>e<=1?(clearInterval(a),0):e-1)},1e3)}catch(e){console.error("Error sending code:",e),x(e instanceof Error?e.message:"发送验证码失败")}finally{h(!1)}},N=async()=>{if(!n||!n.includes("@")){x("请输入有效的邮箱地址");return}if(!d){x("请输入验证码");return}h(!0),x("");try{let e=await fetch("".concat(l,"/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,code:d})}),t=await e.json();if(!e.ok)throw Error(t.error||"登录失败");r(t.token),a(!1)}catch(e){x(e instanceof Error?e.message:"登录失败")}finally{h(!1)}};return(0,s.jsx)(L,{open:t,onOpenChange:a,children:(0,s.jsxs)(A,{className:"sm:max-w-[425px]",children:[(0,s.jsx)(P,{children:(0,s.jsx)(R,{children:"登录"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsx)(c,{type:"email",placeholder:"请输入邮箱",value:n,onChange:e=>i(e.target.value),disabled:p})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(c,{type:"text",placeholder:"请输入验证码",value:d,onChange:e=>u(e.target.value),disabled:p}),(0,s.jsx)(m,{variant:"outline",onClick:v,disabled:p||b>0,className:"whitespace-nowrap min-w-[120px]",children:b>0?"".concat(b,"秒后重试"):"发送验证码"})]}),f&&(0,s.jsx)("div",{className:"text-sm text-red-500",children:f}),(0,s.jsx)(m,{className:"w-full",onClick:N,disabled:p||!g,children:p?"登录中...":"登录"})]})]})})}var Z=a(721);let B=o.forwardRef((e,t)=>{let{className:a,...o}=e;return(0,s.jsx)(Z.fC,{className:n("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...o,ref:t,children:(0,s.jsx)(Z.bU,{className:n("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});function V(e){let{open:t,onOpenChange:a}=e,{t:o}=I(),{userEmail:r,lastSync:l,logout:n,autoSync:c,setAutoSync:i}=(0,z.C)();return(0,s.jsx)(L,{open:t,onOpenChange:a,children:(0,s.jsxs)(A,{className:"sm:max-w-[425px]",children:[(0,s.jsx)(P,{children:(0,s.jsx)(R,{className:"text-xl font-bold",children:o("accountInfo")})}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w,{className:"text-sm font-medium text-gray-500",children:o("email")}),(0,s.jsx)("div",{className:"text-base font-medium text-gray-900",children:r})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w,{className:"text-sm font-medium text-gray-500",children:o("lastSync")}),(0,s.jsx)("div",{className:"text-base font-medium text-gray-900",children:l?new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(l):""})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(w,{className:"text-sm font-medium text-gray-900",children:o("autoSync")}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:o("autoSyncDescription")})]}),(0,s.jsx)(B,{checked:c,onCheckedChange:i})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(m,{onClick:()=>{n(),a(!1)},className:"bg-purple-600 hover:bg-purple-700 text-white transition-colors",children:o("logout")})})]})})}B.displayName=Z.fC.displayName;var $=a(8156),G=a(6346);function M(e){let{open:t,onOpenChange:a,onChoice:o,isLoading:r}=e,{t:l}=I();return(0,s.jsx)(L,{open:t,onOpenChange:a,children:(0,s.jsxs)(A,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(P,{children:[(0,s.jsx)(R,{className:"text-xl font-bold",children:l("syncChoice")}),(0,s.jsx)(J,{children:l("syncChoiceDescription")})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-4",children:[(0,s.jsxs)(m,{className:"flex flex-col items-center gap-2 h-auto py-4",onClick:()=>o(!0),disabled:r,children:[(0,s.jsx)($.Z,{className:"h-8 w-8"}),(0,s.jsx)("span",{className:"text-sm",children:l("uploadLocal")}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:l("uploadLocalDescription")})]}),(0,s.jsxs)(m,{variant:"secondary",className:"flex flex-col items-center gap-2 h-auto py-4",onClick:()=>o(!1),disabled:r,children:[(0,s.jsx)(G.Z,{className:"h-8 w-8"}),(0,s.jsx)("span",{className:"text-sm",children:l("downloadCloud")}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:l("downloadCloudDescription")})]})]})]})})}function Y(e){let{todos:t,onUpdateTodos:a}=e,{isLoggedIn:r,isLoading:l,syncTodos:n,handleLoginSuccess:c}=(0,z.C)(),[i,d]=(0,o.useState)(!1),[u,p]=(0,o.useState)(!1),[h,f]=(0,o.useState)(!1),x=async e=>{c(e),d(!1),f(!0)},g=async e=>{try{if(e)await n(t);else{let e=await n([]);a(e)}f(!1)}catch(e){console.error("Sync error:",e)}},b=async()=>{r?p(!0):d(!0)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{variant:"ghost",size:"icon",onClick:b,disabled:l,className:"text-purple-600 hover:text-purple-700 hover:bg-purple-100 ".concat(l?"animate-pulse":""),children:(0,s.jsx)(y.Z,{className:"h-6 w-6 ".concat(r?"text-purple-600":"text-gray-400")})}),(0,s.jsx)(_,{open:i,onOpenChange:d,onLoginSuccess:x}),(0,s.jsx)(V,{open:u,onOpenChange:p}),(0,s.jsx)(M,{open:h,onOpenChange:f,onChoice:g,isLoading:l})]})}let H="todos",K={startColor:"#F0E6FA",endColor:"#E0F2FE"},W=(0,o.memo)(function(){return(0,s.jsx)("div",{className:"max-w-2xl mx-auto p-4 space-y-4",children:(0,s.jsxs)("div",{className:"p-6 rounded-lg shadow-lg bg-gradient-to-br from-[#F0E6FA] to-[#E0F2FE]",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Todo List"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m,{variant:"ghost",size:"icon",disabled:!0,className:"text-purple-600",children:(0,s.jsx)(y.Z,{className:"h-6 w-6 text-gray-400"})}),(0,s.jsx)(m,{variant:"ghost",size:"icon",disabled:!0,className:"text-purple-600",children:(0,s.jsx)(b.Z,{className:"h-6 w-6 text-gray-400"})})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"0 / 0"})]}),(0,s.jsx)(g,{value:0,className:"w-full h-2 bg-white bg-opacity-50 [&>div]:bg-purple-600"})]})]})})}),X=(0,o.memo)(function(e){let{todo:t,onToggle:a,onDelete:o}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white bg-opacity-50 rounded-md mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(f,{checked:t.completed,onCheckedChange:()=>a(t.id),className:"mr-2"}),(0,s.jsx)("span",{className:"".concat(t.completed?"line-through text-gray-500":"text-gray-800"),children:t.text})]}),(0,s.jsx)(m,{variant:"ghost",size:"icon",onClick:()=>o(t.id),className:"text-red-500 hover:text-red-700 hover:bg-red-100",children:(0,s.jsx)(j.Z,{className:"h-4 w-4"})})]})});function q(){let[e,t]=(0,o.useState)(!1),[a,r]=(0,o.useState)([]),[l,n]=(0,o.useState)(""),[i,d]=(0,o.useState)(!1),{language:u,setLanguage:p,t:h}=I(),{isLoggedIn:f,autoSync:x,syncTodos:y,preferences:j=K,updatePreferences:v}=(0,z.C)(),{startColor:N=K.startColor,endColor:w=K.endColor}=j||K,C=(0,o.useCallback)(async(e,t)=>{try{await v({...j,["start"===e?"startColor":"endColor"]:t})}catch(e){console.error("Failed to update color:",e)}},[j,v]),k=(0,o.useCallback)(()=>{""!==l.trim()&&(r(e=>[...e,{id:crypto.randomUUID(),text:l,completed:!1,color:"#000000",order:e.length}]),n(""))},[l]),E=(0,o.useCallback)(e=>{r(t=>t.map(t=>t.id===e?{...t,completed:!t.completed}:t))},[]),T=(0,o.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),D=(0,o.useCallback)(()=>{p("en"===u?"zh":"en")},[u,p]),L=(0,o.useCallback)(e=>{r(e)},[]);(0,o.useEffect)(()=>{(()=>{try{let e=localStorage.getItem(H);if(e){let t=JSON.parse(e);Array.isArray(t.todos)&&r(t.todos)}}catch(e){console.error("Failed to load data from localStorage:",e)}})(),t(!0)},[]),(0,o.useEffect)(()=>{if(e)try{localStorage.setItem(H,JSON.stringify({todos:a}))}catch(e){console.error("Failed to save to localStorage:",e)}},[a,e]),(0,o.useEffect)(()=>{let t;return f&&x&&e&&(t=setTimeout(()=>{y(a).catch(console.error)},5e3)),()=>{t&&clearTimeout(t)}},[a,f,x,y,e]);let{completedTodos:O,progress:F}=(0,o.useMemo)(()=>{let e=a.length>0?a.filter(e=>e.completed).length:0;return{completedTodos:e,progress:0===a.length?0:e/a.length*100}},[a]),A=(0,o.useMemo)(()=>({background:"linear-gradient(to bottom right, ".concat(N,", ").concat(w,")")}),[N,w]);return e?(0,s.jsx)("div",{className:"max-w-2xl mx-auto p-4 space-y-4",children:(0,s.jsxs)("div",{className:"p-6 rounded-lg shadow-lg",style:A,children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:h("todoList")}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(Y,{todos:a,onUpdateTodos:L}),(0,s.jsx)(m,{variant:"ghost",size:"icon",onClick:D,className:"text-purple-600 hover:text-purple-700 hover:bg-purple-100",children:"zh"===u?(0,s.jsx)("span",{className:"text-lg font-bold",children:"EN"}):(0,s.jsx)("span",{className:"text-lg font-bold",children:"中"})}),(0,s.jsx)(m,{variant:"ghost",size:"icon",onClick:()=>d(!i),className:"text-purple-600 hover:text-purple-700 hover:bg-purple-100",children:(0,s.jsx)(b.Z,{className:"h-6 w-6"})})]})]}),i&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-white bg-opacity-50 rounded-md",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2 text-gray-800",children:h("customizeColors")}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S,{label:h("startColor"),color:N,onChange:e=>C("start",e)}),(0,s.jsx)(S,{label:h("endColor"),color:w,onChange:e=>C("end",e)})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:h("progress")}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[O," / ",a.length," ",h("completed")]})]}),(0,s.jsx)(g,{value:F,className:"w-full h-2 bg-white bg-opacity-50 [&>div]:bg-purple-600"})]}),(0,s.jsxs)("div",{className:"flex mb-4",children:[(0,s.jsx)(c,{type:"text",placeholder:h("addNewTodo"),value:l,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&k(),className:"flex-grow mr-2 border-purple-300 focus:border-purple-500 focus:ring-purple-500"}),(0,s.jsx)(m,{onClick:k,className:"bg-purple-600 hover:bg-purple-700 text-white",children:h("add")})]}),(0,s.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,s.jsx)(X,{todo:e,onToggle:E,onDelete:T},e.id))})]})}):(0,s.jsx)(W,{})}function Q(){return(0,s.jsx)(E,{children:(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-r from-purple-100 via-indigo-100 to-pink-100 py-6",children:(0,s.jsx)(q,{})})})}},4963:function(e,t,a){"use strict";a.d(t,{h:function(){return l}});var s=a(2265);let o="https://colorful-todo-list-kappa.vercel.app/api",r=()=>window.location.hostname.includes("github.io")?"https://colorful-todo-list-kappa.vercel.app/api":"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/api":o,l=()=>{let[e,t]=(0,s.useState)(o);return(0,s.useEffect)(()=>{t(r())},[]),e};r()}},function(e){e.O(0,[953,971,117,744],function(){return e(e.s=9831)}),_N_E=e.O()}]);